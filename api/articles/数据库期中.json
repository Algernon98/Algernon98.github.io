{"title":"【数据库系统概论】期中作业","uid":"66ccb0ab9333327ecb5189567a6954b9","slug":"数据库期中","date":"2022-11-10T12:55:49.000Z","updated":"2022-11-10T12:56:24.430Z","comments":true,"path":"api/articles/数据库期中.json","keywords":null,"cover":[],"content":"<h2 id=\"引言\"><a href=\"#引言\" class=\"headerlink\" title=\"引言\"></a>引言</h2><p>本文基于markdown格式书写，公式及表达式使用latex语句编码。</p>\n<h2 id=\"PART-1\"><a href=\"#PART-1\" class=\"headerlink\" title=\"PART 1\"></a>PART 1</h2><p>1.对于教学数据库的三个基本表<br>s ( SNO , SNAME , AGE , SEX )   sc ( SNO , CNO , CNAME )<br>c ( CNO, CNAME , TEACHER )<br>试用关系代数表达式表示下列查询语句：</p>\n<h4 id=\"1）检索学号为S20220099同学所学课程的课程号和课程名。\"><a href=\"#1）检索学号为S20220099同学所学课程的课程号和课程名。\" class=\"headerlink\" title=\"(1）检索学号为S20220099同学所学课程的课程号和课程名。\"></a>(1）检索学号为S20220099同学所学课程的课程号和课程名。</h4><p>$\\Pi_{CNO,CNAME}(\\sigma_{SNO=’S20220099’}(sc))$</p>\n<h4 id=\"2）检索年龄大于20岁的女同学的学号和姓名。\"><a href=\"#2）检索年龄大于20岁的女同学的学号和姓名。\" class=\"headerlink\" title=\"(2）检索年龄大于20岁的女同学的学号和姓名。\"></a>(2）检索年龄大于20岁的女同学的学号和姓名。</h4><p>$\\Pi_{SNO,SNAME}(\\sigma_{AGE&gt;20 \\bigwedge SEX=’女’}(s))$</p>\n<h4 id=\"3）检索姓名为WANG学生所学课程的课程名与课程号。\"><a href=\"#3）检索姓名为WANG学生所学课程的课程名与课程号。\" class=\"headerlink\" title=\"(3）检索姓名为WANG学生所学课程的课程名与课程号。\"></a>(3）检索姓名为WANG学生所学课程的课程名与课程号。</h4><p>$\\Pi_{CNAME,CNO}(\\sigma_{SNAME=’WANG’}(s \\Join sc))$</p>\n<h4 id=\"4）检索至少教授WANG学生一门课的老师姓名。\"><a href=\"#4）检索至少教授WANG学生一门课的老师姓名。\" class=\"headerlink\" title=\"(4）检索至少教授WANG学生一门课的老师姓名。\"></a>(4）检索至少教授WANG学生一门课的老师姓名。</h4><p>$\\Pi_{TEACHER}(\\sigma_{SNAME=’WANG’\\bigwedge SEX=’男’}(s\\Join c \\Join sc))$</p>\n<h4 id=\"5）检索-WANG-同学不学的课程的课程号。\"><a href=\"#5）检索-WANG-同学不学的课程的课程号。\" class=\"headerlink\" title=\"(5）检索 WANG 同学不学的课程的课程号。\"></a>(5）检索 WANG 同学不学的课程的课程号。</h4><p>$\\Pi_{CNO}(C)-\\Pi_{CNO}(\\sigma_{SNAME=’WANG’}(s\\Join sc))$</p>\n<h4 id=\"6）检索至少教授两门课的教师姓名。\"><a href=\"#6）检索至少教授两门课的教师姓名。\" class=\"headerlink\" title=\"(6）检索至少教授两门课的教师姓名。\"></a>(6）检索至少教授两门课的教师姓名。</h4><p>$\\Pi_{TEACHER}(\\sigma_{C.TECAHER=A.TEACHER \\bigwedge C.CNAME !=A.CNAME}(c \\Join pA(c)))$</p>\n<h4 id=\"7）检索全部学生都选修的课程的课程号与课程名。\"><a href=\"#7）检索全部学生都选修的课程的课程号与课程名。\" class=\"headerlink\" title=\"(7）检索全部学生都选修的课程的课程号与课程名。\"></a>(7）检索全部学生都选修的课程的课程号与课程名。</h4><p>$\\Pi_{CNO,{CNAME}}(C \\Join (\\Pi_{SNO,CNO}(SC)\\div\\Pi_{SNO}(S)) )$</p>\n<h4 id=\"8）检索选修课程包含-WANG-同学所选全部课程的学生学号。\"><a href=\"#8）检索选修课程包含-WANG-同学所选全部课程的学生学号。\" class=\"headerlink\" title=\"(8）检索选修课程包含 WANG 同学所选全部课程的学生学号。\"></a>(8）检索选修课程包含 WANG 同学所选全部课程的学生学号。</h4><p>$\\Pi_{SNO,CNO}(SC)\\div\\Pi_{CNO}(\\sigma_{SNAME=’WANG’}(s \\Join sc))$</p>\n<h2 id=\"PART-2\"><a href=\"#PART-2\" class=\"headerlink\" title=\"PART 2\"></a>PART 2</h2><p>2．对于教学数据库的三个基本表：<br> S ( SNO, SNAME, AGE, SEX )<br> SC ( SNO, CNo, GRADE )<br> C ( CNO, CNAME, TEACHER)<br>试用 SQL 的查询语句表达下列査询：</p>\n<h4 id=\"1）在表-SC-中统计已选修课程的学生人数\"><a href=\"#1）在表-SC-中统计已选修课程的学生人数\" class=\"headerlink\" title=\"(1）在表 SC 中统计已选修课程的学生人数\"></a>(1）在表 SC 中统计已选修课程的学生人数</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--在表 SC 中统计已选修课程的学生人数。\nSELECT COUNT(DISTINCT Sno)\nFROM SC</code></pre>\n<p><img src=\"https://img-blog.csdnimg.cn/7b554028cce74c959a0eda527b0c77b3.png\" alt=\"在这里插入图片描述\"><br>验证：<br><img src=\"https://img-blog.csdnimg.cn/1460192f506849a8b950c576fcc310e4.png\" alt=\"在这里插入图片描述\"><br>SC中已经选秀课程人数为3</p>\n<h4 id=\"2）求选修C0001课程的学生的姓名和性别。\"><a href=\"#2）求选修C0001课程的学生的姓名和性别。\" class=\"headerlink\" title=\"(2）求选修C0001课程的学生的姓名和性别。\"></a>(2）求选修C0001课程的学生的姓名和性别。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--求选修C0001课程的学生的姓名和性别\nSELECT S.Sname,S.Sex\nFROM S,SC\nWHERE SC.Cno&#x3D;&#39;C001&#39; AND SC.Sno&#x3D;S.Sno</code></pre>\n<p><img src=\"https://img-blog.csdnimg.cn/458fbe9f65c04f86a9ca8d473629f099.png\" alt=\"在这里插入图片描述\"><br>验证：<br><img src=\"https://img-blog.csdnimg.cn/0eafad4e75d1477ea5934b81482dce11.png\" alt=\"在这里插入图片描述\"><br>选修C001的仅有S001同学，而S001对应liu同学</p>\n<p><img src=\"https://img-blog.csdnimg.cn/bd28f4bbb5e44fb9abc5ca7dfe1e6024.png\" alt=\"在这里插入图片描述\"></p>\n<h4 id=\"3）求王海同学所上每门课程的该门课学生平均成绩。\"><a href=\"#3）求王海同学所上每门课程的该门课学生平均成绩。\" class=\"headerlink\" title=\"(3）求王海同学所上每门课程的该门课学生平均成绩。\"></a>(3）求王海同学所上每门课程的该门课学生平均成绩。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--求王海同学所上每门课程的该门课学生平均成绩\nSELECT Cname,AVG(Grade) 平均成绩\nFROM SC ,C,S\n\nWHERE SC.Cno&#x3D;C.Cno AND SC.Sno&#x3D;S.Sno AND S.Sname&#x3D;&#39;王海&#39;\nGROUP BY C.Cno,Cname</code></pre>\n<h4 id=\"4）统计每个学生选修课程的门数（超过5门的学生才统计）\"><a href=\"#4）统计每个学生选修课程的门数（超过5门的学生才统计）\" class=\"headerlink\" title=\"(4）统计每个学生选修课程的门数（超过5门的学生才统计）\"></a>(4）统计每个学生选修课程的门数（超过5门的学生才统计）</h4><p>。要求输出学生学号和选修门数，查询结果按门数降序排列，若门数相同，按学号升序排列。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--统计每个学生选修课程的门数（超过5门的学生才统计）。要求输出学生学号和选修门数，查询结果按门数降序排列，若门数相同，按学号升序排列\nSELECT DISTINCT Sno 学生学号,COUNT(Cno) 选修门数\nFROM SC\nGROUP BY  Sno\nHAVING COUNT(Cno)&gt;5\nORDER BY 2 DESC,Sno ASC</code></pre>\n<h4 id=\"5）检索选修C0001课程成绩比-Liu-同学高的男学生姓名。\"><a href=\"#5）检索选修C0001课程成绩比-Liu-同学高的男学生姓名。\" class=\"headerlink\" title=\"(5）检索选修C0001课程成绩比 Liu 同学高的男学生姓名。\"></a>(5）检索选修C0001课程成绩比 Liu 同学高的男学生姓名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--检索选修C0001课程成绩比 Liu 同学高的男学生姓名。\nSELECT Sname\nfrom S,SC\nWHERE S.Sno IN(SELECT Sno\n             FROM SC \n\t\t\t WHERE SC.Grade&gt;(SELECT Grade FROM SC,S WHERE Sname&#x3D;&#39;liu&#39; AND S.Sno&#x3D;SC.Sno AND SC.Cno&#x3D;&#39;C002&#39;)AND SC.Cno&#x3D;&#39;C001&#39;\n\t\t\t )\n       AND S.Sex&#x3D;&#39;男&#39; AND S.Sno&#x3D;SC.Sno AND SC.Cno&#x3D;&#39;C001&#39;</code></pre>\n<h4 id=\"6）在表-SC-中检索成绩为空值的学生的学号和课程号。\"><a href=\"#6）在表-SC-中检索成绩为空值的学生的学号和课程号。\" class=\"headerlink\" title=\"(6）在表 SC 中检索成绩为空值的学生的学号和课程号。\"></a>(6）在表 SC 中检索成绩为空值的学生的学号和课程号。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--在表 SC 中检索成绩为空值的学生的学号和课程号。\nSELECT Sno,Cno\nfrom SC\nWHERE Grade IS  NULL\n</code></pre>\n<h4 id=\"7）检索课程名以-“计算机”-打头的所有课程的课程号和课程名。\"><a href=\"#7）检索课程名以-“计算机”-打头的所有课程的课程号和课程名。\" class=\"headerlink\" title=\"(7）检索课程名以 “计算机” 打头的所有课程的课程号和课程名。\"></a>(7）检索课程名以 “计算机” 打头的所有课程的课程号和课程名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--检索课程名以 “计算机” 打头的所有课程的课程号和课程名\nSELECT DISTINCT  C.Cno,Cname\nfrom SC,C\nWHERE C.Cno&#x3D;SC.Cno AND C.Cname LIKE &#39;计算机%&#39;</code></pre>\n<h4 id=\"8）求选修C0001课程成绩高于该门课程男同学平均成绩的女学生的姓名和年龄。\"><a href=\"#8）求选修C0001课程成绩高于该门课程男同学平均成绩的女学生的姓名和年龄。\" class=\"headerlink\" title=\"(8）求选修C0001课程成绩高于该门课程男同学平均成绩的女学生的姓名和年龄。\"></a>(8）求选修C0001课程成绩高于该门课程男同学平均成绩的女学生的姓名和年龄。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--求选修C0001课程成绩高于该门课程男同学平均成绩的女学生的姓名和年龄\n\n\nSELECT Sname,Age\nFROM S\nWHERE Sno IN(SELECT Sno\n             FROM SC\n\t\t\t WHERE Grade&gt;(SELECT AVG(Grade)\n\t\t\t              FROM SC,S\n\t\t\t\t\t\t  WHERE S.Sno&#x3D;SC.Sno AND S.Sex&#x3D;&#39;男&#39; AND SC.Cno&#x3D;&#39;C001&#39;) \n\t\t\t\t   AND SC.Cno&#x3D;&#39;C001&#39; )\n\t  AND S.Sex&#x3D;&#39;女&#39;</code></pre>\n<h4 id=\"9）检索全部学生都选修的课程的课程号与课程名。\"><a href=\"#9）检索全部学生都选修的课程的课程号与课程名。\" class=\"headerlink\" title=\"(9）检索全部学生都选修的课程的课程号与课程名。\"></a>(9）检索全部学生都选修的课程的课程号与课程名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--检索全部学生都选修的课程的课程号与课程名\n\n Select  Sname from S \n where not Exists (select * from C where not Exists (select * from SC where  Sno&#x3D;S.Sno and Cno&#x3D;C.Cno))\n</code></pre>\n<h4 id=\"10）检索选修课程包含-Liu-老师所授全部课程的学生学号。\"><a href=\"#10）检索选修课程包含-Liu-老师所授全部课程的学生学号。\" class=\"headerlink\" title=\"(10）检索选修课程包含 Liu 老师所授全部课程的学生学号。\"></a>(10）检索选修课程包含 Liu 老师所授全部课程的学生学号。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--检索选修课程包含 Liu 老师所授全部课程的学生学号。\n Select  DISTINCT SC.Sno\n from S\n where exists (select SNO\n from SC,C,S\n where SC.CNO&#x3D;C.CNO and SC.SNO &#x3D; S.SNO and  C.TEACHER &#x3D; &#39;Liu&#39;);\n\n</code></pre>\n<h2 id=\"PART-3\"><a href=\"#PART-3\" class=\"headerlink\" title=\"PART 3\"></a>PART 3</h2><p>3.用 SQL 语句表达对2题中教学数据库关系 S 、 SC 、 C 的更新操作</p>\n<h4 id=\"1）向关系S中插入一条学生记录（“S20220099”，“宋刚”，18，“男”）\"><a href=\"#1）向关系S中插入一条学生记录（“S20220099”，“宋刚”，18，“男”）\" class=\"headerlink\" title=\"(1）向关系S中插入一条学生记录（“S20220099”，“宋刚”，18，“男”）\"></a>(1）向关系S中插入一条学生记录（“S20220099”，“宋刚”，18，“男”）</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--向关系S中插入一条学生记录（“S20220099”，“宋刚”，18，“男”）\n\nINSERT\nINTO S(Sno,Sname,Age,Sex)\nVALUES(&#39;S20220099&#39;,&#39;宋刚&#39;,18,&#39;男&#39;)</code></pre>\n<h4 id=\"2）检索所授每门课程平均成绩均大于80分的教师姓名。\"><a href=\"#2）检索所授每门课程平均成绩均大于80分的教师姓名。\" class=\"headerlink\" title=\"(2）检索所授每门课程平均成绩均大于80分的教师姓名。\"></a>(2）检索所授每门课程平均成绩均大于80分的教师姓名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Select TEACHER \nfrom C a where \nCNO in\n(select CNO \nfrom SC \ngroup by CNO \nhaving avg(GRADE)&gt;80) \ngroup by TEACHER \nhaving count(*)&#x3D;(select count(*) from C b where a.TEACHER&#x3D;b.TEACHER)\n</code></pre>\n<h4 id=\"3）在-C-中删除无授课教师的选课元组。\"><a href=\"#3）在-C-中删除无授课教师的选课元组。\" class=\"headerlink\" title=\"(3）在 C 中删除无授课教师的选课元组。\"></a>(3）在 C 中删除无授课教师的选课元组。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--在 C 中删除无授课教师的选课元组\n\nDELETE FROM C WHERE Teacher IS NULL</code></pre>\n<h4 id=\"4）把选修“区块链技术”课程的女同学选课元组全部删去。\"><a href=\"#4）把选修“区块链技术”课程的女同学选课元组全部删去。\" class=\"headerlink\" title=\"(4）把选修“区块链技术”课程的女同学选课元组全部删去。\"></a>(4）把选修“区块链技术”课程的女同学选课元组全部删去。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n\nDELECT FROM SC\nWHERE Sno IN(SELECT Sno FROM S WHERE Sex &#x3D;&#39;女&#39;)\nAND Cno IN (SELECT Cno FROM C WHERE Cname&#x3D;&#39;区块链技术&#39;)</code></pre>\n<h4 id=\"5）把-MATHS-课六十分以下五十分以上的成绩全改为60分。\"><a href=\"#5）把-MATHS-课六十分以下五十分以上的成绩全改为60分。\" class=\"headerlink\" title=\"(5）把 MATHS 课六十分以下五十分以上的成绩全改为60分。\"></a>(5）把 MATHS 课六十分以下五十分以上的成绩全改为60分。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--把 MATHS 课六十分以下五十分以上的成绩全改为60分\n\nUPDATE SC\nSET Grade &#x3D;60\nWHERE Grade &lt;60 AND Grade &gt;50\nAND Cno IN (SELECT Cno FROM C WHERE Cname&#x3D;&#39;MATHS&#39;)</code></pre>\n<h4 id=\"6）把低于所有课程总平均成绩的同学成绩提高5-。\"><a href=\"#6）把低于所有课程总平均成绩的同学成绩提高5-。\" class=\"headerlink\" title=\"(6）把低于所有课程总平均成绩的同学成绩提高5%。\"></a>(6）把低于所有课程总平均成绩的同学成绩提高5%。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--把低于所有课程总平均成绩的同学成绩提高5%\n\nUPDATE SC\nSET Grade&#x3D;Grade*1.05\nWHERE Sno IN (SELECT Sno FROM S ) AND Grade&lt;(SELECT AVG(Grade) FROM SC)</code></pre>\n<h4 id=\"7）当某个成绩低于该门课程的平均成绩时提高5-。\"><a href=\"#7）当某个成绩低于该门课程的平均成绩时提高5-。\" class=\"headerlink\" title=\"(7）当某个成绩低于该门课程的平均成绩时提高5%。\"></a>(7）当某个成绩低于该门课程的平均成绩时提高5%。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Use education1\nGO\n--当某个成绩低于该门课程的平均成绩时提高5%\n\n\nUPDATE SC\nSET Grade&#x3D;Grade*1.05\nWHERE Grade&lt;(SELECT AVG(Grade)\nFROM SC)</code></pre>\n<h2 id=\"PART-4\"><a href=\"#PART-4\" class=\"headerlink\" title=\"PART 4\"></a>PART 4</h2><p>4．设数据库中有三个关系：<br>职工表 EMP ( ENO , ENAME , AGE , SEX , ECITY )，其属性分别表示职工工号、姓名年龄、性别和籍贯。<br>工作表 WORKS ( ENO , CNO , SALARY )，其属性分别表示职工工号、工作的公司编号和工资。<br>公司表 COMP ( CNO , CNAME , CITY )，其属性分别表示公司编号、公司名称和公司所在城市。<br>试用 SQL 语句写出下列操作：<br>(1）用 CREATE TABLE 语句创建上述三个表，需指出主键和外键。<br>(2）检索超过35岁的男职工的工号和姓名。<br>(3）假设每个职工只能在一个公司工作，检索工资超过1000元的男性职工的工号姓名。<br>(4）假设每个职工可在多个公司工作，检索在编号为C4和C8公司兼职的职工的工号和姓名。<br>(5）检索在“联华公司”工作，工资超过1000元的男性职工的工号和姓名。<br>(6）假设每个职工可在多个公司工作，检索每个职工的兼职公司数目和工资总数，显示（ ENO,NUМ,SUМ_ SALARY )，分别表示工号、公司数目和工资总数。<br>(7）工号为E6的职工在多个公司工作，试检索至少在E6职工兼职的所有公司工作的职工工号。<br>(8）检索华联公司中低于本公可平均工资的职工的工号和姓名。<br>(9）在每一公司中为60岁以上职工加薪100元（若职工为多个公司工作，可重复加）。<br>(10)在 EMP 表和WORKS表中删除年龄大于60岁的职工有关元组。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://blog.csdn.net/practical_sharp/article/details/89484451\">https://blog.csdn.net/practical_sharp/article/details/89484451</a></p></blockquote>\n<h4 id=\"1）用-CREATE-TABLE-语句创建上述三个表，需指出主键和外键。\"><a href=\"#1）用-CREATE-TABLE-语句创建上述三个表，需指出主键和外键。\" class=\"headerlink\" title=\"(1）用 CREATE TABLE 语句创建上述三个表，需指出主键和外键。\"></a>(1）用 CREATE TABLE 语句创建上述三个表，需指出主键和外键。</h4><pre class=\"line-numbers language-cpp\" data-language=\"cpp\"><code class=\"language-cpp\">Use Master;\nGO\nCREATE Database emp1\nON \n(   NAME&#x3D;emp1,\n    FILENAME&#x3D;&#39;C:\\MSML\\sqlserver\\database\\emp.mdf&#39;,\n\tSIZE&#x3D;2,\n\tMAXSIZE&#x3D;unlimited,\n\tFILEGROWTH&#x3D;1\n)\nLOG ON\n(  NAME&#x3D;emp1_log,\n    FILENAME&#x3D;&#39;C:\\MSML\\sqlserver\\database\\emp.ldf&#39;,\n\tSIZE&#x3D;1,\n\tMAXSIZE&#x3D;unlimited,\n\tFILEGROWTH&#x3D;1\n)\nGO\nUse emp1;\n\n\n\nCREATE table EMP(\n\tENO VARCHAR(2) constraint pk_EMP primary key,\n\t\tEname VARCHAR(10) not null,\n\t\t\tage smallint CHECK(age&gt;0 AND age&lt;120),\n\t\t\t\tsex char(2) check ( sex in(&#39;男&#39;,&#39;女&#39;)),\n\t\t\t\t\tEcity varchar(12)\n);\nINSERT into EMP(ENO,Ename,age,sex,Ecity) VALUES (&#39;E1&#39;,&#39;流浪者&#39;,&#39;18&#39;,&#39;男&#39;,&#39;稻妻&#39;);\nINSERT into EMP(ENO,Ename,age,sex,Ecity) VALUES (&#39;E2&#39;,&#39;珐露珊&#39;,&#39;100&#39;,&#39;女&#39;,&#39;须弥&#39;);\nINSERT into EMP(ENO,Ename,age,sex,Ecity) VALUES (&#39;E3&#39;,&#39;优菈&#39;,&#39;24&#39;,&#39;女&#39;,&#39;蒙德&#39;);\nINSERT into EMP(ENO,Ename,age,sex,Ecity) VALUES (&#39;E4&#39;,&#39;纳西妲&#39;,&#39;8&#39;,&#39;女&#39;,&#39;须弥&#39;);\nINSERT into EMP(ENO,Ename,age,sex,Ecity) VALUES (&#39;E5&#39;,&#39;妮露&#39;,&#39;18&#39;,&#39;女&#39;,&#39;须弥&#39;);\nINSERT into EMP(ENO,Ename,age,sex,Ecity) VALUES (&#39;E6&#39;,&#39;赛诺&#39;,&#39;17&#39;,&#39;男&#39;,&#39;须弥&#39;);\nINSERT into EMP(ENO,Ename,age,sex,Ecity) VALUES (&#39;E7&#39;,&#39;达达利亚&#39;,&#39;26&#39;,&#39;男&#39;,&#39;至冬&#39;);\nINSERT into EMP(ENO,Ename,age,sex,Ecity) VALUES (&#39;E8&#39;,&#39;夜兰&#39;,&#39;26&#39;,&#39;女&#39;,&#39;璃月&#39;);\n\nCREATE TABLE COMP(\n\tCNO VARCHAR(4) Constraint pk_Comp primary key,\n\t\tCname VARCHAR(12)  Constraint u_Comp unique,\n\t\t\tCity VARCHAR(12) not null\n);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C1&#39;,&#39;愚人众&#39;,&#39;至冬&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C2&#39;,&#39;教令院&#39;,&#39;须弥&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C3&#39;,&#39;西风骑士团&#39;,&#39;蒙德&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C4&#39;,&#39;净善宫&#39;,&#39;须弥&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C5&#39;,&#39;祖拜尔剧场&#39;,&#39;须弥&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C6&#39;,&#39;缄默之殿&#39;,&#39;须弥&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C7&#39;,&#39;海祇岛&#39;,&#39;稻妻&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C8&#39;,&#39;璃月总务司&#39;,&#39;璃月&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C9&#39;,&#39;社奉行&#39;,&#39;稻妻&#39;);\nINSERT into COMP(CNO,Cname,City) VALUES(&#39;C10&#39;,&#39;镀金旅团&#39;,&#39;须弥&#39;);\n\nCREATE TABLE Works(\n\tENO VARCHAR(2),\n\t\tC VARCHAR(4), \n\t\t\tSalary int check(salary&gt;0),\n\t\t\tConstraint fk_e foreign key(E) references EMP(ENO),\n\t\t\tConstraint fk_c foreign key(C) references COMP(CNO)\n);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E1&#39;,&#39;C3&#39;,&#39;200&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E1&#39;,&#39;C5&#39;,&#39;900&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E2&#39;,&#39;C1&#39;,&#39;3000&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E2&#39;,&#39;C2&#39;,&#39;1000&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E2&#39;,&#39;C8&#39;,&#39;500&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E2&#39;,&#39;C6&#39;,&#39;300&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E3&#39;,&#39;C3&#39;,&#39;320&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E3&#39;,&#39;C7&#39;,&#39;1050&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E3&#39;,&#39;C9&#39;,&#39;250&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E3&#39;,&#39;C10&#39;,&#39;120&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E4&#39;,&#39;C1&#39;,&#39;240&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E4&#39;,&#39;C4&#39;,&#39;20&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E4&#39;,&#39;C6&#39;,&#39;400&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E5&#39;,&#39;C5&#39;,&#39;600&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E5&#39;,&#39;C6&#39;,&#39;1200&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E5&#39;,&#39;C7&#39;,&#39;900&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E5&#39;,&#39;C4&#39;,&#39;200&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E6&#39;,&#39;C7&#39;,&#39;400&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E6&#39;,&#39;C8&#39;,&#39;5000&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E6&#39;,&#39;C4&#39;,&#39;200&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E6&#39;,&#39;C3&#39;,&#39;20&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E7&#39;,&#39;C1&#39;,&#39;300&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E7&#39;,&#39;C2&#39;,&#39;25&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E7&#39;,&#39;C3&#39;,&#39;650&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E8&#39;,&#39;C2&#39;,&#39;4200&#39;);\nINSERT into Works(ENO,CNO,Salary) VALUES(&#39;E8&#39;,&#39;C7&#39;,&#39;21&#39;);\n</code></pre>\n<p><img src=\"https://img-blog.csdnimg.cn/dbf6e1865e494ed1ab684e628f18c257.png\" alt=\"在这里插入图片描述\"></p>\n<h4 id=\"2）检索超过35岁的男职工的工号和姓名。\"><a href=\"#2）检索超过35岁的男职工的工号和姓名。\" class=\"headerlink\" title=\"(2）检索超过35岁的男职工的工号和姓名。\"></a>(2）检索超过35岁的男职工的工号和姓名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">use emp1\nGO\nselect ENO,Ename from EMP where sex &#x3D; &#39;男&#39; AND age&gt;35;</code></pre>\n<h4 id=\"3）假设每个职工只能在一个公司工作，检索工资超过1000元的男性职工的工号姓名。\"><a href=\"#3）假设每个职工只能在一个公司工作，检索工资超过1000元的男性职工的工号姓名。\" class=\"headerlink\" title=\"(3）假设每个职工只能在一个公司工作，检索工资超过1000元的男性职工的工号姓名。\"></a>(3）假设每个职工只能在一个公司工作，检索工资超过1000元的男性职工的工号姓名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">use emp1\nGO\nselect EMP.ENO,EMP.ENAME from EMP,WORKS\n\twhere EMP.ENO &#x3D; WORKS.E AND EMP.SEX &#x3D; &#39;男&#39; AND WORKS.SALARY&gt;1000;</code></pre>\n<h4 id=\"4）假设每个职工可在多个公司工作，检索在编号为C4和C8公司兼职的职工的工号和姓名。\"><a href=\"#4）假设每个职工可在多个公司工作，检索在编号为C4和C8公司兼职的职工的工号和姓名。\" class=\"headerlink\" title=\"(4）假设每个职工可在多个公司工作，检索在编号为C4和C8公司兼职的职工的工号和姓名。\"></a>(4）假设每个职工可在多个公司工作，检索在编号为C4和C8公司兼职的职工的工号和姓名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">use emp1\nGO\nselect ENO,Ename from EMP where ENO in\n\t(select DISTINCT E from WORKS where C &#x3D; &#39;C4&#39; OR C &#x3D; &#39;C8&#39;);</code></pre>\n<h4 id=\"5）检索在“联华公司”工作，工资超过1000元的男性职工的工号和姓名。\"><a href=\"#5）检索在“联华公司”工作，工资超过1000元的男性职工的工号和姓名。\" class=\"headerlink\" title=\"(5）检索在“联华公司”工作，工资超过1000元的男性职工的工号和姓名。\"></a>(5）检索在“联华公司”工作，工资超过1000元的男性职工的工号和姓名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">use emp1\nGO\nselect EMP.ENO,EMP.Ename from EMP,WORKS,COMP \n\t\twhere EMP.ENO &#x3D; WORKS.E AND COMP.CNO &#x3D; WORKS.C AND\n\t\t\t\tEMP.SEX &#x3D; &#39;男&#39; AND WORKS.SALARY&gt;1000 AND COMP.CNAME&#x3D;&#39;联华公司&#39;;</code></pre>\n<h4 id=\"6）假设每个职工可在多个公司工作，检索每个职工的兼职公司数目和工资总数，显示（-ENO-NUМ-SUМ-SALARY-，分别表示工号、公司数目和工资总数。\"><a href=\"#6）假设每个职工可在多个公司工作，检索每个职工的兼职公司数目和工资总数，显示（-ENO-NUМ-SUМ-SALARY-，分别表示工号、公司数目和工资总数。\" class=\"headerlink\" title=\"(6）假设每个职工可在多个公司工作，检索每个职工的兼职公司数目和工资总数，显示（ ENO,NUМ,SUМ_ SALARY )，分别表示工号、公司数目和工资总数。\"></a>(6）假设每个职工可在多个公司工作，检索每个职工的兼职公司数目和工资总数，显示（ ENO,NUМ,SUМ_ SALARY )，分别表示工号、公司数目和工资总数。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">select ENO,COUNT(CNO) NUM,Sum(salary) SUM_SALARY\n   from WORKS\n\t\t\tGROUP BY ENO\n\t\t\t\tORDER BY ENO;\n</code></pre>\n<p><img src=\"https://img-blog.csdnimg.cn/e125b96ce97d465baa8d50b491200060.png\" alt=\"在这里插入图片描述\"></p>\n<h4 id=\"7）工号为E6的职工在多个公司工作，试检索至少在E6职工兼职的所有公司工作的职工工号。\"><a href=\"#7）工号为E6的职工在多个公司工作，试检索至少在E6职工兼职的所有公司工作的职工工号。\" class=\"headerlink\" title=\"(7）工号为E6的职工在多个公司工作，试检索至少在E6职工兼职的所有公司工作的职工工号。\"></a>(7）工号为E6的职工在多个公司工作，试检索至少在E6职工兼职的所有公司工作的职工工号。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">select DISTINCT ENO from WORKS where CNO \n\t\tin (select CNO from WORKS where ENO &#x3D; &#39;E6&#39;)\n\t\t\tORDER BY ENO;</code></pre>\n<p><img src=\"https://img-blog.csdnimg.cn/3ad617c82db9442c938695b3f8417147.png\" alt=\"在这里插入图片描述\"></p>\n<h4 id=\"8）检索华联公司中低于本公可平均工资的职工的工号和姓名。\"><a href=\"#8）检索华联公司中低于本公可平均工资的职工的工号和姓名。\" class=\"headerlink\" title=\"(8）检索华联公司中低于本公可平均工资的职工的工号和姓名。\"></a>(8）检索华联公司中低于本公可平均工资的职工的工号和姓名。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">select WORKS.ENO,EMP.ENAME from WORKS,EMP,  \n\t\t\t(select CNO,avg(salary) avg_SALARY\n\t\t\t\t\t\tfrom WORKS\n\t\t\t\t\t\t\twhere CNO in(select CNO from COMP where cname &#x3D; &#39;联华公司&#39;)\n\t\t\t\t\t\t\t\t\tGROUP BY CNO)tb   \n\t\twhere WORKS.CNO&#x3D;TB.CNO AND EMP.ENO  &#x3D; WORKS.ENO AND  WORKS.SALARY&lt;TB.AVG_SALARY;</code></pre>\n<p>在这里我们创建表的时候没有给出华联公司的信息，用 “教令院”替代</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">select WORKS.ENO,EMP.ENAME from WORKS,EMP,  \n\t\t\t(select CNO,avg(salary) avg_SALARY\n\t\t\t\t\t\tfrom WORKS\n\t\t\t\t\t\t\twhere CNO in(select CNO from COMP where cname &#x3D; &#39;教令院&#39;)\n\t\t\t\t\t\t\t\t\tGROUP BY CNO)tb   \n\t\twhere WORKS.CNO&#x3D;TB.CNO AND EMP.ENO  &#x3D; WORKS.ENO AND  WORKS.SALARY&lt;TB.AVG_SALARY;</code></pre>\n<p><img src=\"https://img-blog.csdnimg.cn/d417a6eef3ab4b2a9cbbac08d5c2566c.png\" alt=\"在这里插入图片描述\"></p>\n<h4 id=\"9）在每一公司中为60岁以上职工加薪100元（若职工为多个公司工作，可重复加）。\"><a href=\"#9）在每一公司中为60岁以上职工加薪100元（若职工为多个公司工作，可重复加）。\" class=\"headerlink\" title=\"(9）在每一公司中为60岁以上职工加薪100元（若职工为多个公司工作，可重复加）。\"></a>(9）在每一公司中为60岁以上职工加薪100元（若职工为多个公司工作，可重复加）。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">update WORKS set SALARY &#x3D; SALARY+100\n\twhere ENO in\n\t\t(select ENO from EMP where EMP.age&gt;60);</code></pre>\n<h4 id=\"10-在-EMP-表和WORKS表中删除年龄大于60岁的职工有关元组。\"><a href=\"#10-在-EMP-表和WORKS表中删除年龄大于60岁的职工有关元组。\" class=\"headerlink\" title=\"(10)在 EMP 表和WORKS表中删除年龄大于60岁的职工有关元组。\"></a>(10)在 EMP 表和WORKS表中删除年龄大于60岁的职工有关元组。</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">delete  from WORKS where ENO in\n\t(select ENO from EMP where age&gt;60);\ndelete from EMP where age&gt;60;</code></pre>\n","text":"引言本文基于markdown格式书写，公式及表达式使用latex语句编码。 PART 11.对于教学数据库的三个基本表s ( SNO , SNAME , AGE , SEX ) sc ( SNO , CNO , CNAME )c ( CNO, CNAME , TEACHER )试...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"信管","slug":"信管","count":10,"path":"api/categories/信管.json"}],"tags":[{"name":"SQL","slug":"SQL","count":3,"path":"api/tags/SQL.json"},{"name":"数据库","slug":"数据库","count":8,"path":"api/tags/数据库.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BC%95%E8%A8%80\"><span class=\"toc-text\">引言</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#PART-1\"><span class=\"toc-text\">PART 1</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%EF%BC%89%E6%A3%80%E7%B4%A2%E5%AD%A6%E5%8F%B7%E4%B8%BAS20220099%E5%90%8C%E5%AD%A6%E6%89%80%E5%AD%A6%E8%AF%BE%E7%A8%8B%E7%9A%84%E8%AF%BE%E7%A8%8B%E5%8F%B7%E5%92%8C%E8%AF%BE%E7%A8%8B%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(1）检索学号为S20220099同学所学课程的课程号和课程名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%EF%BC%89%E6%A3%80%E7%B4%A2%E5%B9%B4%E9%BE%84%E5%A4%A7%E4%BA%8E20%E5%B2%81%E7%9A%84%E5%A5%B3%E5%90%8C%E5%AD%A6%E7%9A%84%E5%AD%A6%E5%8F%B7%E5%92%8C%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(2）检索年龄大于20岁的女同学的学号和姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%EF%BC%89%E6%A3%80%E7%B4%A2%E5%A7%93%E5%90%8D%E4%B8%BAWANG%E5%AD%A6%E7%94%9F%E6%89%80%E5%AD%A6%E8%AF%BE%E7%A8%8B%E7%9A%84%E8%AF%BE%E7%A8%8B%E5%90%8D%E4%B8%8E%E8%AF%BE%E7%A8%8B%E5%8F%B7%E3%80%82\"><span class=\"toc-text\">(3）检索姓名为WANG学生所学课程的课程名与课程号。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%EF%BC%89%E6%A3%80%E7%B4%A2%E8%87%B3%E5%B0%91%E6%95%99%E6%8E%88WANG%E5%AD%A6%E7%94%9F%E4%B8%80%E9%97%A8%E8%AF%BE%E7%9A%84%E8%80%81%E5%B8%88%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(4）检索至少教授WANG学生一门课的老师姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5%EF%BC%89%E6%A3%80%E7%B4%A2-WANG-%E5%90%8C%E5%AD%A6%E4%B8%8D%E5%AD%A6%E7%9A%84%E8%AF%BE%E7%A8%8B%E7%9A%84%E8%AF%BE%E7%A8%8B%E5%8F%B7%E3%80%82\"><span class=\"toc-text\">(5）检索 WANG 同学不学的课程的课程号。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6%EF%BC%89%E6%A3%80%E7%B4%A2%E8%87%B3%E5%B0%91%E6%95%99%E6%8E%88%E4%B8%A4%E9%97%A8%E8%AF%BE%E7%9A%84%E6%95%99%E5%B8%88%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(6）检索至少教授两门课的教师姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#7%EF%BC%89%E6%A3%80%E7%B4%A2%E5%85%A8%E9%83%A8%E5%AD%A6%E7%94%9F%E9%83%BD%E9%80%89%E4%BF%AE%E7%9A%84%E8%AF%BE%E7%A8%8B%E7%9A%84%E8%AF%BE%E7%A8%8B%E5%8F%B7%E4%B8%8E%E8%AF%BE%E7%A8%8B%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(7）检索全部学生都选修的课程的课程号与课程名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#8%EF%BC%89%E6%A3%80%E7%B4%A2%E9%80%89%E4%BF%AE%E8%AF%BE%E7%A8%8B%E5%8C%85%E5%90%AB-WANG-%E5%90%8C%E5%AD%A6%E6%89%80%E9%80%89%E5%85%A8%E9%83%A8%E8%AF%BE%E7%A8%8B%E7%9A%84%E5%AD%A6%E7%94%9F%E5%AD%A6%E5%8F%B7%E3%80%82\"><span class=\"toc-text\">(8）检索选修课程包含 WANG 同学所选全部课程的学生学号。</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#PART-2\"><span class=\"toc-text\">PART 2</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%EF%BC%89%E5%9C%A8%E8%A1%A8-SC-%E4%B8%AD%E7%BB%9F%E8%AE%A1%E5%B7%B2%E9%80%89%E4%BF%AE%E8%AF%BE%E7%A8%8B%E7%9A%84%E5%AD%A6%E7%94%9F%E4%BA%BA%E6%95%B0\"><span class=\"toc-text\">(1）在表 SC 中统计已选修课程的学生人数</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%EF%BC%89%E6%B1%82%E9%80%89%E4%BF%AEC0001%E8%AF%BE%E7%A8%8B%E7%9A%84%E5%AD%A6%E7%94%9F%E7%9A%84%E5%A7%93%E5%90%8D%E5%92%8C%E6%80%A7%E5%88%AB%E3%80%82\"><span class=\"toc-text\">(2）求选修C0001课程的学生的姓名和性别。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%EF%BC%89%E6%B1%82%E7%8E%8B%E6%B5%B7%E5%90%8C%E5%AD%A6%E6%89%80%E4%B8%8A%E6%AF%8F%E9%97%A8%E8%AF%BE%E7%A8%8B%E7%9A%84%E8%AF%A5%E9%97%A8%E8%AF%BE%E5%AD%A6%E7%94%9F%E5%B9%B3%E5%9D%87%E6%88%90%E7%BB%A9%E3%80%82\"><span class=\"toc-text\">(3）求王海同学所上每门课程的该门课学生平均成绩。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%EF%BC%89%E7%BB%9F%E8%AE%A1%E6%AF%8F%E4%B8%AA%E5%AD%A6%E7%94%9F%E9%80%89%E4%BF%AE%E8%AF%BE%E7%A8%8B%E7%9A%84%E9%97%A8%E6%95%B0%EF%BC%88%E8%B6%85%E8%BF%875%E9%97%A8%E7%9A%84%E5%AD%A6%E7%94%9F%E6%89%8D%E7%BB%9F%E8%AE%A1%EF%BC%89\"><span class=\"toc-text\">(4）统计每个学生选修课程的门数（超过5门的学生才统计）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5%EF%BC%89%E6%A3%80%E7%B4%A2%E9%80%89%E4%BF%AEC0001%E8%AF%BE%E7%A8%8B%E6%88%90%E7%BB%A9%E6%AF%94-Liu-%E5%90%8C%E5%AD%A6%E9%AB%98%E7%9A%84%E7%94%B7%E5%AD%A6%E7%94%9F%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(5）检索选修C0001课程成绩比 Liu 同学高的男学生姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6%EF%BC%89%E5%9C%A8%E8%A1%A8-SC-%E4%B8%AD%E6%A3%80%E7%B4%A2%E6%88%90%E7%BB%A9%E4%B8%BA%E7%A9%BA%E5%80%BC%E7%9A%84%E5%AD%A6%E7%94%9F%E7%9A%84%E5%AD%A6%E5%8F%B7%E5%92%8C%E8%AF%BE%E7%A8%8B%E5%8F%B7%E3%80%82\"><span class=\"toc-text\">(6）在表 SC 中检索成绩为空值的学生的学号和课程号。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#7%EF%BC%89%E6%A3%80%E7%B4%A2%E8%AF%BE%E7%A8%8B%E5%90%8D%E4%BB%A5-%E2%80%9C%E8%AE%A1%E7%AE%97%E6%9C%BA%E2%80%9D-%E6%89%93%E5%A4%B4%E7%9A%84%E6%89%80%E6%9C%89%E8%AF%BE%E7%A8%8B%E7%9A%84%E8%AF%BE%E7%A8%8B%E5%8F%B7%E5%92%8C%E8%AF%BE%E7%A8%8B%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(7）检索课程名以 “计算机” 打头的所有课程的课程号和课程名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#8%EF%BC%89%E6%B1%82%E9%80%89%E4%BF%AEC0001%E8%AF%BE%E7%A8%8B%E6%88%90%E7%BB%A9%E9%AB%98%E4%BA%8E%E8%AF%A5%E9%97%A8%E8%AF%BE%E7%A8%8B%E7%94%B7%E5%90%8C%E5%AD%A6%E5%B9%B3%E5%9D%87%E6%88%90%E7%BB%A9%E7%9A%84%E5%A5%B3%E5%AD%A6%E7%94%9F%E7%9A%84%E5%A7%93%E5%90%8D%E5%92%8C%E5%B9%B4%E9%BE%84%E3%80%82\"><span class=\"toc-text\">(8）求选修C0001课程成绩高于该门课程男同学平均成绩的女学生的姓名和年龄。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#9%EF%BC%89%E6%A3%80%E7%B4%A2%E5%85%A8%E9%83%A8%E5%AD%A6%E7%94%9F%E9%83%BD%E9%80%89%E4%BF%AE%E7%9A%84%E8%AF%BE%E7%A8%8B%E7%9A%84%E8%AF%BE%E7%A8%8B%E5%8F%B7%E4%B8%8E%E8%AF%BE%E7%A8%8B%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(9）检索全部学生都选修的课程的课程号与课程名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#10%EF%BC%89%E6%A3%80%E7%B4%A2%E9%80%89%E4%BF%AE%E8%AF%BE%E7%A8%8B%E5%8C%85%E5%90%AB-Liu-%E8%80%81%E5%B8%88%E6%89%80%E6%8E%88%E5%85%A8%E9%83%A8%E8%AF%BE%E7%A8%8B%E7%9A%84%E5%AD%A6%E7%94%9F%E5%AD%A6%E5%8F%B7%E3%80%82\"><span class=\"toc-text\">(10）检索选修课程包含 Liu 老师所授全部课程的学生学号。</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#PART-3\"><span class=\"toc-text\">PART 3</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%EF%BC%89%E5%90%91%E5%85%B3%E7%B3%BBS%E4%B8%AD%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E5%AD%A6%E7%94%9F%E8%AE%B0%E5%BD%95%EF%BC%88%E2%80%9CS20220099%E2%80%9D%EF%BC%8C%E2%80%9C%E5%AE%8B%E5%88%9A%E2%80%9D%EF%BC%8C18%EF%BC%8C%E2%80%9C%E7%94%B7%E2%80%9D%EF%BC%89\"><span class=\"toc-text\">(1）向关系S中插入一条学生记录（“S20220099”，“宋刚”，18，“男”）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%EF%BC%89%E6%A3%80%E7%B4%A2%E6%89%80%E6%8E%88%E6%AF%8F%E9%97%A8%E8%AF%BE%E7%A8%8B%E5%B9%B3%E5%9D%87%E6%88%90%E7%BB%A9%E5%9D%87%E5%A4%A7%E4%BA%8E80%E5%88%86%E7%9A%84%E6%95%99%E5%B8%88%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(2）检索所授每门课程平均成绩均大于80分的教师姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%EF%BC%89%E5%9C%A8-C-%E4%B8%AD%E5%88%A0%E9%99%A4%E6%97%A0%E6%8E%88%E8%AF%BE%E6%95%99%E5%B8%88%E7%9A%84%E9%80%89%E8%AF%BE%E5%85%83%E7%BB%84%E3%80%82\"><span class=\"toc-text\">(3）在 C 中删除无授课教师的选课元组。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%EF%BC%89%E6%8A%8A%E9%80%89%E4%BF%AE%E2%80%9C%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E2%80%9D%E8%AF%BE%E7%A8%8B%E7%9A%84%E5%A5%B3%E5%90%8C%E5%AD%A6%E9%80%89%E8%AF%BE%E5%85%83%E7%BB%84%E5%85%A8%E9%83%A8%E5%88%A0%E5%8E%BB%E3%80%82\"><span class=\"toc-text\">(4）把选修“区块链技术”课程的女同学选课元组全部删去。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5%EF%BC%89%E6%8A%8A-MATHS-%E8%AF%BE%E5%85%AD%E5%8D%81%E5%88%86%E4%BB%A5%E4%B8%8B%E4%BA%94%E5%8D%81%E5%88%86%E4%BB%A5%E4%B8%8A%E7%9A%84%E6%88%90%E7%BB%A9%E5%85%A8%E6%94%B9%E4%B8%BA60%E5%88%86%E3%80%82\"><span class=\"toc-text\">(5）把 MATHS 课六十分以下五十分以上的成绩全改为60分。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6%EF%BC%89%E6%8A%8A%E4%BD%8E%E4%BA%8E%E6%89%80%E6%9C%89%E8%AF%BE%E7%A8%8B%E6%80%BB%E5%B9%B3%E5%9D%87%E6%88%90%E7%BB%A9%E7%9A%84%E5%90%8C%E5%AD%A6%E6%88%90%E7%BB%A9%E6%8F%90%E9%AB%985-%E3%80%82\"><span class=\"toc-text\">(6）把低于所有课程总平均成绩的同学成绩提高5%。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#7%EF%BC%89%E5%BD%93%E6%9F%90%E4%B8%AA%E6%88%90%E7%BB%A9%E4%BD%8E%E4%BA%8E%E8%AF%A5%E9%97%A8%E8%AF%BE%E7%A8%8B%E7%9A%84%E5%B9%B3%E5%9D%87%E6%88%90%E7%BB%A9%E6%97%B6%E6%8F%90%E9%AB%985-%E3%80%82\"><span class=\"toc-text\">(7）当某个成绩低于该门课程的平均成绩时提高5%。</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#PART-4\"><span class=\"toc-text\">PART 4</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%EF%BC%89%E7%94%A8-CREATE-TABLE-%E8%AF%AD%E5%8F%A5%E5%88%9B%E5%BB%BA%E4%B8%8A%E8%BF%B0%E4%B8%89%E4%B8%AA%E8%A1%A8%EF%BC%8C%E9%9C%80%E6%8C%87%E5%87%BA%E4%B8%BB%E9%94%AE%E5%92%8C%E5%A4%96%E9%94%AE%E3%80%82\"><span class=\"toc-text\">(1）用 CREATE TABLE 语句创建上述三个表，需指出主键和外键。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%EF%BC%89%E6%A3%80%E7%B4%A2%E8%B6%85%E8%BF%8735%E5%B2%81%E7%9A%84%E7%94%B7%E8%81%8C%E5%B7%A5%E7%9A%84%E5%B7%A5%E5%8F%B7%E5%92%8C%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(2）检索超过35岁的男职工的工号和姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%EF%BC%89%E5%81%87%E8%AE%BE%E6%AF%8F%E4%B8%AA%E8%81%8C%E5%B7%A5%E5%8F%AA%E8%83%BD%E5%9C%A8%E4%B8%80%E4%B8%AA%E5%85%AC%E5%8F%B8%E5%B7%A5%E4%BD%9C%EF%BC%8C%E6%A3%80%E7%B4%A2%E5%B7%A5%E8%B5%84%E8%B6%85%E8%BF%871000%E5%85%83%E7%9A%84%E7%94%B7%E6%80%A7%E8%81%8C%E5%B7%A5%E7%9A%84%E5%B7%A5%E5%8F%B7%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(3）假设每个职工只能在一个公司工作，检索工资超过1000元的男性职工的工号姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%EF%BC%89%E5%81%87%E8%AE%BE%E6%AF%8F%E4%B8%AA%E8%81%8C%E5%B7%A5%E5%8F%AF%E5%9C%A8%E5%A4%9A%E4%B8%AA%E5%85%AC%E5%8F%B8%E5%B7%A5%E4%BD%9C%EF%BC%8C%E6%A3%80%E7%B4%A2%E5%9C%A8%E7%BC%96%E5%8F%B7%E4%B8%BAC4%E5%92%8CC8%E5%85%AC%E5%8F%B8%E5%85%BC%E8%81%8C%E7%9A%84%E8%81%8C%E5%B7%A5%E7%9A%84%E5%B7%A5%E5%8F%B7%E5%92%8C%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(4）假设每个职工可在多个公司工作，检索在编号为C4和C8公司兼职的职工的工号和姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5%EF%BC%89%E6%A3%80%E7%B4%A2%E5%9C%A8%E2%80%9C%E8%81%94%E5%8D%8E%E5%85%AC%E5%8F%B8%E2%80%9D%E5%B7%A5%E4%BD%9C%EF%BC%8C%E5%B7%A5%E8%B5%84%E8%B6%85%E8%BF%871000%E5%85%83%E7%9A%84%E7%94%B7%E6%80%A7%E8%81%8C%E5%B7%A5%E7%9A%84%E5%B7%A5%E5%8F%B7%E5%92%8C%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(5）检索在“联华公司”工作，工资超过1000元的男性职工的工号和姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6%EF%BC%89%E5%81%87%E8%AE%BE%E6%AF%8F%E4%B8%AA%E8%81%8C%E5%B7%A5%E5%8F%AF%E5%9C%A8%E5%A4%9A%E4%B8%AA%E5%85%AC%E5%8F%B8%E5%B7%A5%E4%BD%9C%EF%BC%8C%E6%A3%80%E7%B4%A2%E6%AF%8F%E4%B8%AA%E8%81%8C%E5%B7%A5%E7%9A%84%E5%85%BC%E8%81%8C%E5%85%AC%E5%8F%B8%E6%95%B0%E7%9B%AE%E5%92%8C%E5%B7%A5%E8%B5%84%E6%80%BB%E6%95%B0%EF%BC%8C%E6%98%BE%E7%A4%BA%EF%BC%88-ENO-NU%D0%9C-SU%D0%9C-SALARY-%EF%BC%8C%E5%88%86%E5%88%AB%E8%A1%A8%E7%A4%BA%E5%B7%A5%E5%8F%B7%E3%80%81%E5%85%AC%E5%8F%B8%E6%95%B0%E7%9B%AE%E5%92%8C%E5%B7%A5%E8%B5%84%E6%80%BB%E6%95%B0%E3%80%82\"><span class=\"toc-text\">(6）假设每个职工可在多个公司工作，检索每个职工的兼职公司数目和工资总数，显示（ ENO,NUМ,SUМ_ SALARY )，分别表示工号、公司数目和工资总数。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#7%EF%BC%89%E5%B7%A5%E5%8F%B7%E4%B8%BAE6%E7%9A%84%E8%81%8C%E5%B7%A5%E5%9C%A8%E5%A4%9A%E4%B8%AA%E5%85%AC%E5%8F%B8%E5%B7%A5%E4%BD%9C%EF%BC%8C%E8%AF%95%E6%A3%80%E7%B4%A2%E8%87%B3%E5%B0%91%E5%9C%A8E6%E8%81%8C%E5%B7%A5%E5%85%BC%E8%81%8C%E7%9A%84%E6%89%80%E6%9C%89%E5%85%AC%E5%8F%B8%E5%B7%A5%E4%BD%9C%E7%9A%84%E8%81%8C%E5%B7%A5%E5%B7%A5%E5%8F%B7%E3%80%82\"><span class=\"toc-text\">(7）工号为E6的职工在多个公司工作，试检索至少在E6职工兼职的所有公司工作的职工工号。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#8%EF%BC%89%E6%A3%80%E7%B4%A2%E5%8D%8E%E8%81%94%E5%85%AC%E5%8F%B8%E4%B8%AD%E4%BD%8E%E4%BA%8E%E6%9C%AC%E5%85%AC%E5%8F%AF%E5%B9%B3%E5%9D%87%E5%B7%A5%E8%B5%84%E7%9A%84%E8%81%8C%E5%B7%A5%E7%9A%84%E5%B7%A5%E5%8F%B7%E5%92%8C%E5%A7%93%E5%90%8D%E3%80%82\"><span class=\"toc-text\">(8）检索华联公司中低于本公可平均工资的职工的工号和姓名。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#9%EF%BC%89%E5%9C%A8%E6%AF%8F%E4%B8%80%E5%85%AC%E5%8F%B8%E4%B8%AD%E4%B8%BA60%E5%B2%81%E4%BB%A5%E4%B8%8A%E8%81%8C%E5%B7%A5%E5%8A%A0%E8%96%AA100%E5%85%83%EF%BC%88%E8%8B%A5%E8%81%8C%E5%B7%A5%E4%B8%BA%E5%A4%9A%E4%B8%AA%E5%85%AC%E5%8F%B8%E5%B7%A5%E4%BD%9C%EF%BC%8C%E5%8F%AF%E9%87%8D%E5%A4%8D%E5%8A%A0%EF%BC%89%E3%80%82\"><span class=\"toc-text\">(9）在每一公司中为60岁以上职工加薪100元（若职工为多个公司工作，可重复加）。</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#10-%E5%9C%A8-EMP-%E8%A1%A8%E5%92%8CWORKS%E8%A1%A8%E4%B8%AD%E5%88%A0%E9%99%A4%E5%B9%B4%E9%BE%84%E5%A4%A7%E4%BA%8E60%E5%B2%81%E7%9A%84%E8%81%8C%E5%B7%A5%E6%9C%89%E5%85%B3%E5%85%83%E7%BB%84%E3%80%82\"><span class=\"toc-text\">(10)在 EMP 表和WORKS表中删除年龄大于60岁的职工有关元组。</span></a></li></ol></li></ol></li></ol>","author":{"name":"Algernon","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/68c4c7d8696c482da565ab5c8ebfa2fa.png","link":"/","description":"谁也没见过风，更别说我和你了","socials":{"github":"https://github.com/Algernon98","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Algernon98","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-line.svg","link":"https://space.bilibili.com/281724502"}}}},"mapped":true,"prev_post":{"title":"【Python程序设计】图像手绘效果","uid":"6b5256e96ce5fae4261cb8ad62f96b03","slug":"PYTHON手绘效果","date":"2022-11-11T09:13:49.000Z","updated":"2022-11-11T09:14:12.460Z","comments":true,"path":"api/articles/PYTHON手绘效果.json","keywords":null,"cover":[],"text":"科学计算与可视化图像的手绘效果 from PIL import Image import numpy as np im&#x3D;np.array(Image.open(&quot;C:\\\\Users\\\\83854\\\\Pictures\\\\Saved Pictures\\\\15802...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"编程语言","slug":"编程语言","count":13,"path":"api/categories/编程语言.json"}],"tags":[{"name":"python","slug":"python","count":9,"path":"api/tags/python.json"},{"name":"cv","slug":"cv","count":1,"path":"api/tags/cv.json"}],"author":{"name":"Algernon","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/68c4c7d8696c482da565ab5c8ebfa2fa.png","link":"/","description":"谁也没见过风，更别说我和你了","socials":{"github":"https://github.com/Algernon98","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Algernon98","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-line.svg","link":"https://space.bilibili.com/281724502"}}}}},"next_post":{"title":"【区块链技术与应用】（六）","uid":"0d120f5730c7a7a14db4689c0e15f358","slug":"区块链6","date":"2022-11-10T03:23:49.000Z","updated":"2022-11-10T03:24:15.394Z","comments":true,"path":"api/articles/区块链6.json","keywords":null,"cover":[],"text":" 引言本次任务相对顺利，因为是已经打包的案例。不过二三案例中不像案例一中有go的chaincode,执行需要花时间debug 案例链接： https://pkg.go.dev/github.com/hyperledger/fabric-gateway/pkg/client#sec...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"10 mins."},"categories":[{"name":"信管","slug":"信管","count":10,"path":"api/categories/信管.json"}],"tags":[{"name":"区块链","slug":"区块链","count":8,"path":"api/tags/区块链.json"}],"author":{"name":"Algernon","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/68c4c7d8696c482da565ab5c8ebfa2fa.png","link":"/","description":"谁也没见过风，更别说我和你了","socials":{"github":"https://github.com/Algernon98","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Algernon98","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-line.svg","link":"https://space.bilibili.com/281724502"}}}}}}